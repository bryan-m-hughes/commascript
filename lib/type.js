"use strict";
Object.defineProperties(exports, {
  BooleanType: {get: function() {
      return BooleanType;
    }},
  NumberType: {get: function() {
      return NumberType;
    }},
  StringType: {get: function() {
      return StringType;
    }},
  RegExpType: {get: function() {
      return RegExpType;
    }},
  NullType: {get: function() {
      return NullType;
    }},
  ObjectType: {get: function() {
      return ObjectType;
    }},
  ArrayType: {get: function() {
      return ArrayType;
    }},
  FunctionType: {get: function() {
      return FunctionType;
    }},
  ConstructorType: {get: function() {
      return ConstructorType;
    }},
  InvalidType: {get: function() {
      return InvalidType;
    }},
  isPrimitive: {get: function() {
      return isPrimitive;
    }},
  compareTypes: {get: function() {
      return compareTypes;
    }},
  __esModule: {value: true}
});
var $__state__;
var $__0 = ($__state__ = require("./state"), $__state__ && $__state__.__esModule && $__state__ || {default: $__state__}),
    handleError = $__0.handleError,
    handleInternalError = $__0.handleInternalError,
    getRelativeCurrentFile = $__0.getRelativeCurrentFile;
var Type = function Type(options) {
  this.name = options.name;
  this.node = options.node;
  this.declarationLocation = options.declarationLocation;
};
($traceurRuntime.createClass)(Type, {}, {});
var BooleanType = function BooleanType(options) {
  options.name = 'boolean';
  $traceurRuntime.superCall(this, $BooleanType.prototype, "constructor", [options]);
};
var $BooleanType = BooleanType;
($traceurRuntime.createClass)(BooleanType, {}, {}, Type);
var NumberType = function NumberType(options) {
  options.name = 'number';
  $traceurRuntime.superCall(this, $NumberType.prototype, "constructor", [options]);
};
var $NumberType = NumberType;
($traceurRuntime.createClass)(NumberType, {}, {}, Type);
var StringType = function StringType(options) {
  options.name = 'string';
  $traceurRuntime.superCall(this, $StringType.prototype, "constructor", [options]);
};
var $StringType = StringType;
($traceurRuntime.createClass)(StringType, {}, {}, Type);
var RegExpType = function RegExpType(options) {
  options.name = 'regexp';
  $traceurRuntime.superCall(this, $RegExpType.prototype, "constructor", [options]);
};
var $RegExpType = RegExpType;
($traceurRuntime.createClass)(RegExpType, {}, {}, Type);
var NullType = function NullType(options) {
  options.name = 'null';
  $traceurRuntime.superCall(this, $NullType.prototype, "constructor", [options]);
};
var $NullType = NullType;
($traceurRuntime.createClass)(NullType, {}, {}, Type);
var ObjectType = function ObjectType(options) {
  options.name = options.name || 'anonymous object';
  $traceurRuntime.superCall(this, $ObjectType.prototype, "constructor", [options]);
  this.properties = options.properties || {};
  this.proto = options.proto || null;
};
var $ObjectType = ObjectType;
($traceurRuntime.createClass)(ObjectType, {}, {}, Type);
var ArrayType = function ArrayType(options) {
  options.name = options.name || 'anonymous array';
  $traceurRuntime.superCall(this, $ArrayType.prototype, "constructor", [options]);
  if (!options || !options.elementType) {
    handleInternalError('Invalid options passed to ArrayType constructor.');
  }
  this.elementType = options.elementType;
};
var $ArrayType = ArrayType;
($traceurRuntime.createClass)(ArrayType, {}, {}, Type);
var FunctionType = function FunctionType(options) {
  options.name = options.name || 'anonymous function';
  $traceurRuntime.superCall(this, $FunctionType.prototype, "constructor", [options]);
  this.argumentTypes = options.arguments || [];
  this.returnType = options.returnType || null;
};
var $FunctionType = FunctionType;
($traceurRuntime.createClass)(FunctionType, {
  applyCall: function(options) {
    throw new Error('Not Implemented');
  },
  applyCast: function(options) {
    throw new Error('Not Implemented');
  }
}, {}, Type);
var ConstructorType = function ConstructorType(options) {
  if (!options || !options.name || !options.instantiatedType) {
    handleInternalError('Invalid options passed to ConstructorType constructor.');
  }
  $traceurRuntime.superCall(this, $ConstructorType.prototype, "constructor", [options.name]);
  this.argumentTypes = options.argumentTypes || [];
  this.instantiatedType = options.instantiatedType;
};
var $ConstructorType = ConstructorType;
($traceurRuntime.createClass)(ConstructorType, {}, {}, Type);
var InvalidType = function InvalidType(options) {
  options.name = 'Invalid Type';
  $traceurRuntime.superCall(this, $InvalidType.prototype, "constructor", [options]);
};
var $InvalidType = InvalidType;
($traceurRuntime.createClass)(InvalidType, {}, {}, Type);
function isPrimitive(type) {
  return type instanceof BooleanType || type instanceof NumberType || type instanceof StringType;
}
function compareTypes(type1, type2, options) {
  if (!options || !options.node) {
    handleInternalError('Invalid options passed to compareTypes.');
  }
  if (type1 == type2) {
    return true;
  }
  function handleCompareError(errorMessage) {
    handleError(options.node, 'Cannot cast "' + type1.name + '" as "' + type2.name + '"' + (errorMessage ? ': ' + errorMessage : ''));
  }
  if (isPrimitive(type1) && isPrimitive(type2)) {
    if ((type1 instanceof BooleanType && type2 instanceof BooleanType) || (type1 instanceof NumberType && type2 instanceof NumberType) || (type1 instanceof StringType && type2 instanceof StringType)) {
      return true;
    } else {
      handleCompareError();
      return false;
    }
  }
  var p;
  if (type1 instanceof ObjectType && type2 instanceof ObjectType) {
    if (!compareTypes(type1.proto, type2.proto, options)) {
      return false;
    }
    if (Object.keys(type1.properties).length != Object.keys(type2.properties).length) {
      handleCompareError('Objects do not contain the same number of properties');
      return false;
    }
    for (p in type1.properties) {
      if (!type2.properties[p]) {
        handleCompareError('Object type is missing property "' + p + '"');
        return false;
      }
      if (!compareTypes(type1.properties[p], type2.properties[p], options)) {
        handleCompareError('Property "' + p + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  var i;
  if (type1 instanceof FunctionType && type2 instanceof FunctionType) {
    if (!compareTypes(type1.returnType, type2.returnType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Functions do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  if (type1 instanceof ConstructorType && type2 instanceof ConstructorType) {
    if (!compareTypes(type1.instantiatedType, type2.instantiatedType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Constructors do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  return false;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGUuanMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci80IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci81IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzAiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci84IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzkiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0JBO0FDeEJBLEtBQUssaUJBQWlCLEFBQUMsQ0FBQyxPQUFNO2FDQTlCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHdCQUF3QjtJQUFFLEFEQTlCLENBQUM7WUFBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUsdUJBQXdCO0lBQUUsQURBOUIsQ0FBQztZQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSx1QkFBd0I7SUFBRSxBREE5QixDQUFDO1lBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHVCQUF3QjtJQUFFLEFEQTlCLENBQUM7VUFBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUscUJBQXdCO0lBQUUsQURBOUIsQ0FBQztZQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSx1QkFBd0I7SUFBRSxBREE5QixDQUFDO1dBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHNCQUF3QjtJQUFFLEFEQTlCLENBQUM7Y0FBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUseUJBQXdC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aUJBQWlCLENBQUcsQ0FBQSxLQUFJLGlCQUFpQixDQUFHLFFBQU0sQ0FBQyxDQUFHO0FBQzFFLFdBQU8sTUFBSSxDQUFDO0lBQ2Q7QUFBQSxBQUNBLE9BQUksS0FBSSxjQUFjLE9BQU8sR0FBSyxDQUFBLEtBQUksY0FBYyxPQUFPLENBQUc7QUFDNUQsdUJBQWlCLEFBQUMsQ0FBQywwREFBeUQsQ0FBQyxDQUFDO0FBQzlFLFdBQU8sTUFBSSxDQUFDO0lBQ2Q7QUFBQSxBQUNBLFFBQUssQ0FBQSxFQUFJLEVBQUEsQ0FBRyxDQUFBLENBQUEsRUFBSSxDQUFBLEtBQUksY0FBYyxPQUFPLENBQUcsQ0FBQSxDQUFBLEVBQUUsQ0FBRztBQUMvQyxTQUFJLENBQUMsWUFBVyxBQUFDLENBQUMsS0FBSSxjQUFjLENBQUUsQ0FBQSxDQUFDLENBQUcsQ0FBQSxLQUFJLGNBQWMsQ0FBRSxDQUFBLENBQUMsQ0FBRyxRQUFNLENBQUMsQ0FBRztBQUMxRSx5QkFBaUIsQUFBQyxDQUFDLFlBQVcsRUFBSSxFQUFBLENBQUEsQ0FBSSxrQkFBZ0IsQ0FBQyxDQUFDO0FBQ3hELGFBQU8sTUFBSSxDQUFDO01BQ2Q7QUFBQSxJQUNGO0FBQUEsQUFDQSxTQUFPLEtBQUcsQ0FBQztFQUNiO0FBQUEsQUFFQSxPQUFPLE1BQUksQ0FBQztBQUNkO0FBQUEiLCJmaWxlIjoidHlwZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5UaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuQ29weXJpZ2h0IChjKSAyMDEzLTIwMTQgQnJ5YW4gSHVnaGVzIDxicnlhbkB0aGVvcmV0aWNhbGlkZWF0aW9ucy5jb20+IChodHRwOi8vdGhlb3JldGljYWxpZGVhdGlvbnMuY29tKVxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG4qL1xuXG5pbXBvcnQgeyBoYW5kbGVFcnJvciwgaGFuZGxlSW50ZXJuYWxFcnJvciwgZ2V0UmVsYXRpdmVDdXJyZW50RmlsZSB9IGZyb20gJy4vc3RhdGUnO1xuXG5jbGFzcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICB0aGlzLm5vZGUgPSBvcHRpb25zLm5vZGU7XG4gICAgdGhpcy5kZWNsYXJhdGlvbkxvY2F0aW9uID0gb3B0aW9ucy5kZWNsYXJhdGlvbkxvY2F0aW9uO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBCb29sZWFuVHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucy5uYW1lID0gJ2Jvb2xlYW4nO1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOdW1iZXJUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLm5hbWUgPSAnbnVtYmVyJztcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3RyaW5nVHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucy5uYW1lID0gJ3N0cmluZyc7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlZ0V4cFR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIG9wdGlvbnMubmFtZSA9ICdyZWdleHAnXG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE51bGxUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLm5hbWUgPSAnbnVsbCc7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE9iamVjdFR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIG9wdGlvbnMubmFtZSA9IG9wdGlvbnMubmFtZSB8fCAnYW5vbnltb3VzIG9iamVjdCc7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy5wcm9wZXJ0aWVzID0gb3B0aW9ucy5wcm9wZXJ0aWVzIHx8IHt9O1xuICAgIHRoaXMucHJvdG8gPSBvcHRpb25zLnByb3RvIHx8IG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFycmF5VHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucy5uYW1lID0gb3B0aW9ucy5uYW1lIHx8ICdhbm9ueW1vdXMgYXJyYXknO1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5lbGVtZW50VHlwZSkge1xuICAgICAgaGFuZGxlSW50ZXJuYWxFcnJvcignSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBBcnJheVR5cGUgY29uc3RydWN0b3IuJyk7XG4gICAgfVxuICAgIHRoaXMuZWxlbWVudFR5cGUgPSBvcHRpb25zLmVsZW1lbnRUeXBlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGdW5jdGlvblR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIG9wdGlvbnMubmFtZSA9IG9wdGlvbnMubmFtZSB8fCAnYW5vbnltb3VzIGZ1bmN0aW9uJztcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICB0aGlzLmFyZ3VtZW50VHlwZXMgPSBvcHRpb25zLmFyZ3VtZW50cyB8fCBbXTtcbiAgICB0aGlzLnJldHVyblR5cGUgPSBvcHRpb25zLnJldHVyblR5cGUgfHwgbnVsbDtcbiAgfVxuICBhcHBseUNhbGwob3B0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcignTm90IEltcGxlbWVudGVkJyk7XG4gIH1cbiAgYXBwbHlDYXN0KG9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBJbXBsZW1lbnRlZCcpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDb25zdHJ1Y3RvclR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5uYW1lIHx8ICFvcHRpb25zLmluc3RhbnRpYXRlZFR5cGUpIHtcbiAgICAgIGhhbmRsZUludGVybmFsRXJyb3IoJ0ludmFsaWQgb3B0aW9ucyBwYXNzZWQgdG8gQ29uc3RydWN0b3JUeXBlIGNvbnN0cnVjdG9yLicpO1xuICAgIH1cbiAgICBzdXBlcihvcHRpb25zLm5hbWUpO1xuICAgIHRoaXMuYXJndW1lbnRUeXBlcyA9IG9wdGlvbnMuYXJndW1lbnRUeXBlcyB8fCBbXTtcbiAgICB0aGlzLmluc3RhbnRpYXRlZFR5cGUgPSBvcHRpb25zLmluc3RhbnRpYXRlZFR5cGU7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEludmFsaWRUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLm5hbWUgPSAnSW52YWxpZCBUeXBlJztcbiAgICBzdXBlcihvcHRpb25zKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ByaW1pdGl2ZSh0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgQm9vbGVhblR5cGUgfHxcbiAgICB0eXBlIGluc3RhbmNlb2YgTnVtYmVyVHlwZSB8fCB0eXBlIGluc3RhbmNlb2YgU3RyaW5nVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVUeXBlcyh0eXBlMSwgdHlwZTIsIG9wdGlvbnMpIHtcblxuICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubm9kZSkge1xuICAgIGhhbmRsZUludGVybmFsRXJyb3IoJ0ludmFsaWQgb3B0aW9ucyBwYXNzZWQgdG8gY29tcGFyZVR5cGVzLicpO1xuICB9XG4gIGlmICh0eXBlMSA9PSB0eXBlMikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ29tcGFyZUVycm9yKGVycm9yTWVzc2FnZSkge1xuICAgIGhhbmRsZUVycm9yKG9wdGlvbnMubm9kZSwgJ0Nhbm5vdCBjYXN0IFwiJyArXG4gICAgICB0eXBlMS5uYW1lICsgJ1wiIGFzIFwiJyArIHR5cGUyLm5hbWUgKyAnXCInICtcbiAgICAgIChlcnJvck1lc3NhZ2UgPyAnOiAnICsgZXJyb3JNZXNzYWdlIDogJycpKTtcbiAgfVxuXG4gIGlmIChpc1ByaW1pdGl2ZSh0eXBlMSkgJiYgaXNQcmltaXRpdmUodHlwZTIpKSB7XG4gICAgaWYgKCh0eXBlMSBpbnN0YW5jZW9mIEJvb2xlYW5UeXBlICYmIHR5cGUyIGluc3RhbmNlb2YgQm9vbGVhblR5cGUpIHx8XG4gICAgICAodHlwZTEgaW5zdGFuY2VvZiBOdW1iZXJUeXBlICYmIHR5cGUyIGluc3RhbmNlb2YgTnVtYmVyVHlwZSkgfHxcbiAgICAgICh0eXBlMSBpbnN0YW5jZW9mIFN0cmluZ1R5cGUgJiYgdHlwZTIgaW5zdGFuY2VvZiBTdHJpbmdUeXBlKVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcigpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHZhciBwO1xuICBpZiAodHlwZTEgaW5zdGFuY2VvZiBPYmplY3RUeXBlICYmIHR5cGUyIGluc3RhbmNlb2YgT2JqZWN0VHlwZSkge1xuICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLnByb3RvLCB0eXBlMi5wcm90bywgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKHR5cGUxLnByb3BlcnRpZXMpLmxlbmd0aCAhPSBPYmplY3Qua2V5cyh0eXBlMi5wcm9wZXJ0aWVzKS5sZW5ndGgpIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignT2JqZWN0cyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllcycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKHAgaW4gdHlwZTEucHJvcGVydGllcykge1xuICAgICAgaWYgKCF0eXBlMi5wcm9wZXJ0aWVzW3BdKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignT2JqZWN0IHR5cGUgaXMgbWlzc2luZyBwcm9wZXJ0eSBcIicgKyBwICsgJ1wiJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLnByb3BlcnRpZXNbcF0sIHR5cGUyLnByb3BlcnRpZXNbcF0sIG9wdGlvbnMpKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignUHJvcGVydHkgXCInICsgcCArICdcIiB0eXBlIG1pc21hdGNoJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBUT0RPOiBOZWVkIHRvIHJldGhpbmsgaW4gdGVybXMgb2YgcGFydGlhbCBkZWZpbml0aW9uc1xuICB2YXIgaTtcbiAgaWYgKHR5cGUxIGluc3RhbmNlb2YgRnVuY3Rpb25UeXBlICYmIHR5cGUyIGluc3RhbmNlb2YgRnVuY3Rpb25UeXBlKSB7XG4gICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEucmV0dXJuVHlwZSwgdHlwZTIucmV0dXJuVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoICE9IHR5cGUyLmFyZ3VtZW50VHlwZXMubGVuZ3RoKSB7XG4gICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0Z1bmN0aW9ucyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCB0eXBlMS5hcmd1bWVudFR5cGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5hcmd1bWVudFR5cGVzW2ldLCB0eXBlMi5hcmd1bWVudFR5cGVzW2ldLCBvcHRpb25zKSkge1xuICAgICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0FyZ3VtZW50IFwiJyArIGkgKyAnXCIgdHlwZSBtaXNtYXRjaCcpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgaWYgKHR5cGUxIGluc3RhbmNlb2YgQ29uc3RydWN0b3JUeXBlICYmIHR5cGUyIGluc3RhbmNlb2YgQ29uc3RydWN0b3JUeXBlKSB7XG4gICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEuaW5zdGFudGlhdGVkVHlwZSwgdHlwZTIuaW5zdGFudGlhdGVkVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoICE9IHR5cGUyLmFyZ3VtZW50VHlwZXMubGVuZ3RoKSB7XG4gICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0NvbnN0cnVjdG9ycyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCB0eXBlMS5hcmd1bWVudFR5cGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5hcmd1bWVudFR5cGVzW2ldLCB0eXBlMi5hcmd1bWVudFR5cGVzW2ldLCBvcHRpb25zKSkge1xuICAgICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0FyZ3VtZW50IFwiJyArIGkgKyAnXCIgdHlwZSBtaXNtYXRjaCcpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwiT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywgJF9fcGxhY2Vob2xkZXJfXzApOyIsIntnZXQ6ICRfX3BsYWNlaG9sZGVyX18wfSIsImdldCAkX19wbGFjZWhvbGRlcl9fMCgpIHsgcmV0dXJuICRfX3BsYWNlaG9sZGVyX18xOyB9IiwiX19lc01vZHVsZTogdHJ1ZSIsInt2YWx1ZTogJF9fcGxhY2Vob2xkZXJfXzB9IiwiKCRfX3BsYWNlaG9sZGVyX18wID0gcmVxdWlyZSgkX19wbGFjZWhvbGRlcl9fMSksIFxuICAgICAgICAkX19wbGFjZWhvbGRlcl9fMiAmJiAkX19wbGFjZWhvbGRlcl9fMy5fX2VzTW9kdWxlICYmICRfX3BsYWNlaG9sZGVyX180IHx8IHtkZWZhdWx0OiAkX19wbGFjZWhvbGRlcl9fNX0pIiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yKSIsIiR0cmFjZXVyUnVudGltZS5zdXBlckNhbGwoJF9fcGxhY2Vob2xkZXJfXzAsICRfX3BsYWNlaG9sZGVyX18xLCAkX19wbGFjZWhvbGRlcl9fMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzMpIiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzMpIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
"use strict";
Object.defineProperties(exports, {
  BooleanType: {get: function() {
      return BooleanType;
    }},
  NumberType: {get: function() {
      return NumberType;
    }},
  StringType: {get: function() {
      return StringType;
    }},
  ObjectType: {get: function() {
      return ObjectType;
    }},
  RegExpType: {get: function() {
      return RegExpType;
    }},
  NullType: {get: function() {
      return NullType;
    }},
  ArrayType: {get: function() {
      return ArrayType;
    }},
  FunctionType: {get: function() {
      return FunctionType;
    }},
  ConstructorType: {get: function() {
      return ConstructorType;
    }},
  isBoolean: {get: function() {
      return isBoolean;
    }},
  isNumber: {get: function() {
      return isNumber;
    }},
  isString: {get: function() {
      return isString;
    }},
  isPrimitive: {get: function() {
      return isPrimitive;
    }},
  isObject: {get: function() {
      return isObject;
    }},
  isRegExp: {get: function() {
      return isRegExp;
    }},
  isNull: {get: function() {
      return isNull;
    }},
  isArray: {get: function() {
      return isArray;
    }},
  isFunction: {get: function() {
      return isFunction;
    }},
  isConstructor: {get: function() {
      return isConstructor;
    }},
  compareTypes: {get: function() {
      return compareTypes;
    }},
  __esModule: {value: true}
});
var $__state__;
var $__0 = ($__state__ = require("./state"), $__state__ && $__state__.__esModule && $__state__ || {default: $__state__}),
    handleError = $__0.handleError,
    handleInternalError = $__0.handleInternalError;
var Type = function Type(options) {
  this.name = options.name;
  this.declarationLocation = options.declarationLocation;
};
($traceurRuntime.createClass)(Type, {}, {});
var BooleanType = function BooleanType() {
  $traceurRuntime.superCall(this, $BooleanType.prototype, "constructor", [{name: 'boolean'}]);
};
var $BooleanType = BooleanType;
($traceurRuntime.createClass)(BooleanType, {}, {}, Type);
var NumberType = function NumberType() {
  $traceurRuntime.superCall(this, $NumberType.prototype, "constructor", [{name: 'number'}]);
};
var $NumberType = NumberType;
($traceurRuntime.createClass)(NumberType, {}, {}, Type);
var StringType = function StringType() {
  $traceurRuntime.superCall(this, $StringType.prototype, "constructor", [{name: 'string'}]);
};
var $StringType = StringType;
($traceurRuntime.createClass)(StringType, {}, {}, Type);
var ObjectType = function ObjectType(options) {
  options = options || {};
  $traceurRuntime.superCall(this, $ObjectType.prototype, "constructor", [options.name || 'anonymous object']);
  this.properties = options.properties || {};
  this.proto = options.proto || null;
};
var $ObjectType = ObjectType;
($traceurRuntime.createClass)(ObjectType, {}, {}, Type);
var RegExpType = function RegExpType() {
  $traceurRuntime.superCall(this, $RegExpType.prototype, "constructor", [{name: 'regexp'}]);
};
var $RegExpType = RegExpType;
($traceurRuntime.createClass)(RegExpType, {}, {}, Type);
var NullType = function NullType() {
  $traceurRuntime.superCall(this, $NullType.prototype, "constructor", [{name: 'null'}]);
};
var $NullType = NullType;
($traceurRuntime.createClass)(NullType, {}, {}, Type);
var ArrayType = function ArrayType() {
  if (!options || !options.elementType) {
    handleInternalError('Invalid options passed to ArrayType constructor.');
  }
  $traceurRuntime.superCall(this, $ArrayType.prototype, "constructor", [options.name || 'anonymous array']);
  this.elementType = options.elementType;
};
var $ArrayType = ArrayType;
($traceurRuntime.createClass)(ArrayType, {}, {}, Type);
var FunctionType = function FunctionType(options) {
  if (!options || !options.node) {
    handleInternalError('Invalid options passed to FunctionType constructor.');
  }
  $traceurRuntime.superCall(this, $FunctionType.prototype, "constructor", [options.name || 'anonymous function']);
  this.node = options.node;
  this.argumentTypes = options.arguments || [];
  this.returnType = options.returnType || null;
};
var $FunctionType = FunctionType;
($traceurRuntime.createClass)(FunctionType, {applyPattern: function(options) {
    if (!options || !options.argumentTypes || !options.returnType) {
      handleInternalError('Invalid options passed to FunctionType constructor.');
    }
  }}, {}, Type);
var ConstructorType = function ConstructorType(options) {
  if (!options || !options.name || !options.instantiatedType) {
    handleInternalError('Invalid options passed to ConstructorType constructor.');
  }
  $traceurRuntime.superCall(this, $ConstructorType.prototype, "constructor", [options.name]);
  this.argumentTypes = options.argumentTypes || [];
  this.instantiatedType = options.instantiatedType;
};
var $ConstructorType = ConstructorType;
($traceurRuntime.createClass)(ConstructorType, {}, {}, Type);
function isBoolean(type) {
  return type instanceof BooleanType;
}
function isNumber(type) {
  return type instanceof NumberType;
}
function isString(type) {
  return type instanceof StringType;
}
function isPrimitive(type) {
  return isBoolean(type) || isNumber(type) || isString(type);
}
function isObject(type) {
  return type instanceof ObjectType;
}
function isRegExp(type) {
  return type instanceof RegExpType;
}
function isNull(type) {
  return type instanceof NullType;
}
function isArray(type) {
  return type instanceof ArrayType;
}
function isFunction(type) {
  return type instanceof FunctionType;
}
function isConstructor(type) {
  return type instanceof ConstructorType;
}
function compareTypes(type1, type2, options) {
  if (!options || !options.node) {
    handleInternalError('Invalid options passed to compareTypes.');
  }
  if (type1 == type2) {
    return true;
  }
  function handleCompareError(errorMessage) {
    handleError(options.node, 'Cannot cast "' + type1.name + '" (declared at ' + type1.declarationLocation + ') as "' + type2.name + '" (declared at ' + type2.declarationLocation + ')' + (errorMessage ? ': ' + errorMessage : ''));
  }
  if (isPrimitive(type1) && isPrimitive(type2)) {
    if ((isBoolean(type1) && isBoolean(type2)) || (isNumber(type1) && isNumber(type2)) || (isString(type1) && isString(type2))) {
      return true;
    } else {
      handleCompareError();
      return false;
    }
  }
  var p;
  if (isObject(type1) && isObject(type2)) {
    if (!compareTypes(type1.proto, type2.proto, options)) {
      return false;
    }
    if (Object.keys(type1.properties).length != Object.keys(type2.properties).length) {
      handleCompareError('Objects do not contain the same number of properties');
      return false;
    }
    for (p in type1.properties) {
      if (!type2.properties[p]) {
        handleCompareError('Object type is missing property "' + p + '"');
        return false;
      }
      if (!compareTypes(type1.properties[p], type2.properties[p], options)) {
        handleCompareError('Property "' + p + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  var i;
  if (isFunction(type1) && isFunction(type2)) {
    if (!compareTypes(type1.returnType, type2.returnType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Functions do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  if (isConstructor(type1) && isConstructor(type2)) {
    if (!compareTypes(type1.instantiatedType, type2.instantiatedType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Constructors do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  return false;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGUuanMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci80IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci81IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzAiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci84IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzkiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0JBO0FDeEJBLEtBQUssaUJBQWlCLEFBQUMsQ0FBQyxPQUFNO2FDQTlCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHdCQUF3QjtJQUFFLEFEQTlCLENBQUM7WUFBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUsdUJBQXdCO0lBQUUsQURBOUIsQ0FBQztZQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSx1QkFBd0I7SUFBRSxBREE5QixDQUFDO1lBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHVCQUF3QjtJQUFFLEFEQTlCLENBQUM7WUFBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUsdUJBQXdCO0lBQUUsQURBOUIsQ0FBQztVQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSxxQkFBd0I7SUFBRSxBREE5QixDQUFDO1dBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHNCQUF3QjtJQUFFLEFEQTlCLENBQUM7Y0FBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUseUJBQXdC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QUFHLENBQUM7RUFDYjtBQUFBLEFBRUEsS0FBSSxhQUFZLEFBQUMsQ0FBQyxLQUFJLENBQUMsQ0FBQSxFQUFLLENBQUEsYUFBWSxBQUFDLENBQUMsS0FBSSxDQUFDLENBQUc7QUFDaEQsT0FBSSxDQUFDLFlBQVcsQUFBQyxDQUFDLEtBQUksaUJBQWlCLENBQUcsQ0FBQSxLQUFJLGlCQUFpQixDQUFHLFFBQU0sQ0FBQyxDQUFHO0FBQzFFLFdBQU8sTUFBSSxDQUFDO0lBQ2Q7QUFBQSxBQUNBLE9BQUksS0FBSSxjQUFjLE9BQU8sR0FBSyxDQUFBLEtBQUksY0FBYyxPQUFPLENBQUc7QUFDNUQsdUJBQWlCLEFBQUMsQ0FBQywwREFBeUQsQ0FBQyxDQUFDO0FBQzlFLFdBQU8sTUFBSSxDQUFDO0lBQ2Q7QUFBQSxBQUNBLFFBQUssQ0FBQSxFQUFJLEVBQUEsQ0FBRyxDQUFBLENBQUEsRUFBSSxDQUFBLEtBQUksY0FBYyxPQUFPLENBQUcsQ0FBQSxDQUFBLEVBQUUsQ0FBRztBQUMvQyxTQUFJLENBQUMsWUFBVyxBQUFDLENBQUMsS0FBSSxjQUFjLENBQUUsQ0FBQSxDQUFDLENBQUcsQ0FBQSxLQUFJLGNBQWMsQ0FBRSxDQUFBLENBQUMsQ0FBRyxRQUFNLENBQUMsQ0FBRztBQUMxRSx5QkFBaUIsQUFBQyxDQUFDLFlBQVcsRUFBSSxFQUFBLENBQUEsQ0FBSSxrQkFBZ0IsQ0FBQyxDQUFDO0FBQ3hELGFBQU8sTUFBSSxDQUFDO01BQ2Q7QUFBQSxJQUNGO0FBQUEsQUFDQSxTQUFPLEtBQUcsQ0FBQztFQUNiO0FBQUEsQUFFQSxPQUFPLE1BQUksQ0FBQztBQUNkO0FBQUEiLCJmaWxlIjoidHlwZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5UaGUgTUlUIExpY2Vuc2UgKE1JVClcblxuQ29weXJpZ2h0IChjKSAyMDEzLTIwMTQgQnJ5YW4gSHVnaGVzIDxicnlhbkB0aGVvcmV0aWNhbGlkZWF0aW9ucy5jb20+IChodHRwOi8vdGhlb3JldGljYWxpZGVhdGlvbnMuY29tKVxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XG5vZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG50byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsXG5jb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG5GSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbkxJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG5PVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG5USEUgU09GVFdBUkUuXG4qL1xuXG5pbXBvcnQgeyBoYW5kbGVFcnJvciwgaGFuZGxlSW50ZXJuYWxFcnJvciB9IGZyb20gJy4vc3RhdGUnO1xuXG5jbGFzcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICB0aGlzLmRlY2xhcmF0aW9uTG9jYXRpb24gPSBvcHRpb25zLmRlY2xhcmF0aW9uTG9jYXRpb247XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJvb2xlYW5UeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHsgbmFtZTogJ2Jvb2xlYW4nIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOdW1iZXJUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHsgbmFtZTogJ251bWJlcicgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0cmluZ1R5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyBuYW1lOiAnc3RyaW5nJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgT2JqZWN0VHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgc3VwZXIob3B0aW9ucy5uYW1lIHx8ICdhbm9ueW1vdXMgb2JqZWN0Jyk7XG4gICAgdGhpcy5wcm9wZXJ0aWVzID0gb3B0aW9ucy5wcm9wZXJ0aWVzIHx8IHt9O1xuICAgIHRoaXMucHJvdG8gPSBvcHRpb25zLnByb3RvIHx8IG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlZ0V4cFR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyBuYW1lOiAncmVnZXhwJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTnVsbFR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyBuYW1lOiAnbnVsbCcgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFycmF5VHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMuZWxlbWVudFR5cGUpIHtcbiAgICBoYW5kbGVJbnRlcm5hbEVycm9yKCdJbnZhbGlkIG9wdGlvbnMgcGFzc2VkIHRvIEFycmF5VHlwZSBjb25zdHJ1Y3Rvci4nKTtcbiAgfVxuICBzdXBlcihvcHRpb25zLm5hbWUgfHwgJ2Fub255bW91cyBhcnJheScpO1xuICB0aGlzLmVsZW1lbnRUeXBlID0gb3B0aW9ucy5lbGVtZW50VHlwZTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRnVuY3Rpb25UeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubm9kZSkge1xuICAgICAgaGFuZGxlSW50ZXJuYWxFcnJvcignSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBGdW5jdGlvblR5cGUgY29uc3RydWN0b3IuJyk7XG4gICAgfVxuICAgIHN1cGVyKG9wdGlvbnMubmFtZSB8fCAnYW5vbnltb3VzIGZ1bmN0aW9uJyk7XG4gICAgdGhpcy5ub2RlID0gb3B0aW9ucy5ub2RlO1xuICAgIHRoaXMuYXJndW1lbnRUeXBlcyA9IG9wdGlvbnMuYXJndW1lbnRzIHx8IFtdO1xuICAgIHRoaXMucmV0dXJuVHlwZSA9IG9wdGlvbnMucmV0dXJuVHlwZSB8fCBudWxsO1xuICB9XG4gIGFwcGx5UGF0dGVybihvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zIHx8ICFvcHRpb25zLmFyZ3VtZW50VHlwZXMgfHwgIW9wdGlvbnMucmV0dXJuVHlwZSkge1xuICAgICAgaGFuZGxlSW50ZXJuYWxFcnJvcignSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBGdW5jdGlvblR5cGUgY29uc3RydWN0b3IuJyk7XG4gICAgfVxuICAgIC8vIFRPRE86IFRoaXMgaXMgY2FsbGVkIGJ5IGNhbGwgZXhwcmVzc2lvbnMgdG8gc29saWRpZnkgdHlwZXMuIEFuYWxheXplcyBmdW5jdGlvbiBhdCB0aGlzIHBvaW50IGluIHRpbWUuXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnN0cnVjdG9yVHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zIHx8ICFvcHRpb25zLm5hbWUgfHwgIW9wdGlvbnMuaW5zdGFudGlhdGVkVHlwZSkge1xuICAgICAgaGFuZGxlSW50ZXJuYWxFcnJvcignSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBDb25zdHJ1Y3RvclR5cGUgY29uc3RydWN0b3IuJyk7XG4gICAgfVxuICAgIHN1cGVyKG9wdGlvbnMubmFtZSk7XG4gICAgdGhpcy5hcmd1bWVudFR5cGVzID0gb3B0aW9ucy5hcmd1bWVudFR5cGVzIHx8IFtdO1xuICAgIHRoaXMuaW5zdGFudGlhdGVkVHlwZSA9IG9wdGlvbnMuaW5zdGFudGlhdGVkVHlwZTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNCb29sZWFuKHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBCb29sZWFuVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBOdW1iZXJUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTdHJpbmcodHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIFN0cmluZ1R5cGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ByaW1pdGl2ZSh0eXBlKSB7XG4gIHJldHVybiBpc0Jvb2xlYW4odHlwZSkgfHwgaXNOdW1iZXIodHlwZSkgfHwgaXNTdHJpbmcodHlwZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgT2JqZWN0VHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVnRXhwKHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBSZWdFeHBUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOdWxsKHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBOdWxsVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQXJyYXkodHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIEFycmF5VHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24odHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIEZ1bmN0aW9uVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29uc3RydWN0b3IodHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVUeXBlcyh0eXBlMSwgdHlwZTIsIG9wdGlvbnMpIHtcblxuICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubm9kZSkge1xuICAgIGhhbmRsZUludGVybmFsRXJyb3IoJ0ludmFsaWQgb3B0aW9ucyBwYXNzZWQgdG8gY29tcGFyZVR5cGVzLicpO1xuICB9XG4gIGlmICh0eXBlMSA9PSB0eXBlMikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlQ29tcGFyZUVycm9yKGVycm9yTWVzc2FnZSkge1xuICAgIGhhbmRsZUVycm9yKG9wdGlvbnMubm9kZSwgJ0Nhbm5vdCBjYXN0IFwiJyArIHR5cGUxLm5hbWUgKyAnXCIgKGRlY2xhcmVkIGF0ICcgKyB0eXBlMS5kZWNsYXJhdGlvbkxvY2F0aW9uICtcbiAgICAgICcpIGFzIFwiJyArIHR5cGUyLm5hbWUgKyAnXCIgKGRlY2xhcmVkIGF0ICcgKyB0eXBlMi5kZWNsYXJhdGlvbkxvY2F0aW9uICsgJyknICtcbiAgICAgIChlcnJvck1lc3NhZ2UgPyAnOiAnICsgZXJyb3JNZXNzYWdlIDogJycpKTtcbiAgfVxuXG4gIGlmIChpc1ByaW1pdGl2ZSh0eXBlMSkgJiYgaXNQcmltaXRpdmUodHlwZTIpKSB7XG4gICAgaWYgKChpc0Jvb2xlYW4odHlwZTEpICYmIGlzQm9vbGVhbih0eXBlMikpIHx8XG4gICAgICAoaXNOdW1iZXIodHlwZTEpICYmIGlzTnVtYmVyKHR5cGUyKSkgfHxcbiAgICAgIChpc1N0cmluZyh0eXBlMSkgJiYgaXNTdHJpbmcodHlwZTIpKVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcigpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHZhciBwO1xuICBpZiAoaXNPYmplY3QodHlwZTEpICYmIGlzT2JqZWN0KHR5cGUyKSkge1xuICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLnByb3RvLCB0eXBlMi5wcm90bywgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKHR5cGUxLnByb3BlcnRpZXMpLmxlbmd0aCAhPSBPYmplY3Qua2V5cyh0eXBlMi5wcm9wZXJ0aWVzKS5sZW5ndGgpIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignT2JqZWN0cyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllcycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKHAgaW4gdHlwZTEucHJvcGVydGllcykge1xuICAgICAgaWYgKCF0eXBlMi5wcm9wZXJ0aWVzW3BdKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignT2JqZWN0IHR5cGUgaXMgbWlzc2luZyBwcm9wZXJ0eSBcIicgKyBwICsgJ1wiJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLnByb3BlcnRpZXNbcF0sIHR5cGUyLnByb3BlcnRpZXNbcF0sIG9wdGlvbnMpKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignUHJvcGVydHkgXCInICsgcCArICdcIiB0eXBlIG1pc21hdGNoJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBUT0RPOiBOZWVkIHRvIHJldGhpbmsgaW4gdGVybXMgb2YgcGFydGlhbCBkZWZpbml0aW9uc1xuICB2YXIgaTtcbiAgaWYgKGlzRnVuY3Rpb24odHlwZTEpICYmIGlzRnVuY3Rpb24odHlwZTIpKSB7XG4gICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEucmV0dXJuVHlwZSwgdHlwZTIucmV0dXJuVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoICE9IHR5cGUyLmFyZ3VtZW50VHlwZXMubGVuZ3RoKSB7XG4gICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0Z1bmN0aW9ucyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCB0eXBlMS5hcmd1bWVudFR5cGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5hcmd1bWVudFR5cGVzW2ldLCB0eXBlMi5hcmd1bWVudFR5cGVzW2ldLCBvcHRpb25zKSkge1xuICAgICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0FyZ3VtZW50IFwiJyArIGkgKyAnXCIgdHlwZSBtaXNtYXRjaCcpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgaWYgKGlzQ29uc3RydWN0b3IodHlwZTEpICYmIGlzQ29uc3RydWN0b3IodHlwZTIpKSB7XG4gICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEuaW5zdGFudGlhdGVkVHlwZSwgdHlwZTIuaW5zdGFudGlhdGVkVHlwZSwgb3B0aW9ucykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoICE9IHR5cGUyLmFyZ3VtZW50VHlwZXMubGVuZ3RoKSB7XG4gICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0NvbnN0cnVjdG9ycyBkbyBub3QgY29udGFpbiB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCB0eXBlMS5hcmd1bWVudFR5cGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5hcmd1bWVudFR5cGVzW2ldLCB0eXBlMi5hcmd1bWVudFR5cGVzW2ldLCBvcHRpb25zKSkge1xuICAgICAgICBoYW5kbGVDb21wYXJlRXJyb3IoJ0FyZ3VtZW50IFwiJyArIGkgKyAnXCIgdHlwZSBtaXNtYXRjaCcpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwiT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywgJF9fcGxhY2Vob2xkZXJfXzApOyIsIntnZXQ6ICRfX3BsYWNlaG9sZGVyX18wfSIsImdldCAkX19wbGFjZWhvbGRlcl9fMCgpIHsgcmV0dXJuICRfX3BsYWNlaG9sZGVyX18xOyB9IiwiX19lc01vZHVsZTogdHJ1ZSIsInt2YWx1ZTogJF9fcGxhY2Vob2xkZXJfXzB9IiwiKCRfX3BsYWNlaG9sZGVyX18wID0gcmVxdWlyZSgkX19wbGFjZWhvbGRlcl9fMSksIFxuICAgICAgICAkX19wbGFjZWhvbGRlcl9fMiAmJiAkX19wbGFjZWhvbGRlcl9fMy5fX2VzTW9kdWxlICYmICRfX3BsYWNlaG9sZGVyX180IHx8IHtkZWZhdWx0OiAkX19wbGFjZWhvbGRlcl9fNX0pIiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yKSIsIiR0cmFjZXVyUnVudGltZS5zdXBlckNhbGwoJF9fcGxhY2Vob2xkZXJfXzAsICRfX3BsYWNlaG9sZGVyX18xLCAkX19wbGFjZWhvbGRlcl9fMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzMpIiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzMpIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
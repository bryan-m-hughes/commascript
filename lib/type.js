"use strict";
Object.defineProperties(exports, {
  BooleanType: {get: function() {
      return BooleanType;
    }},
  NumberType: {get: function() {
      return NumberType;
    }},
  StringType: {get: function() {
      return StringType;
    }},
  ObjectType: {get: function() {
      return ObjectType;
    }},
  ArrayType: {get: function() {
      return ArrayType;
    }},
  FunctionType: {get: function() {
      return FunctionType;
    }},
  ConstructorType: {get: function() {
      return ConstructorType;
    }},
  isBoolean: {get: function() {
      return isBoolean;
    }},
  isNumber: {get: function() {
      return isNumber;
    }},
  isString: {get: function() {
      return isString;
    }},
  isPrimitive: {get: function() {
      return isPrimitive;
    }},
  isObject: {get: function() {
      return isObject;
    }},
  isArray: {get: function() {
      return isArray;
    }},
  isFunction: {get: function() {
      return isFunction;
    }},
  isConstructor: {get: function() {
      return isConstructor;
    }},
  compareTypes: {get: function() {
      return compareTypes;
    }},
  __esModule: {value: true}
});
var $__state__;
var $__0 = ($__state__ = require("./state"), $__state__ && $__state__.__esModule && $__state__ || {default: $__state__}),
    handleError = $__0.handleError,
    handleInternalError = $__0.handleInternalError;
var Type = function Type(options) {
  this.name = options.name;
  this.declarationLocation = options.declarationLocation;
};
($traceurRuntime.createClass)(Type, {}, {});
var BooleanType = function BooleanType() {
  $traceurRuntime.superCall(this, $BooleanType.prototype, "constructor", [{name: 'boolean'}]);
};
var $BooleanType = BooleanType;
($traceurRuntime.createClass)(BooleanType, {}, {}, Type);
var NumberType = function NumberType() {
  $traceurRuntime.superCall(this, $NumberType.prototype, "constructor", [{name: 'number'}]);
};
var $NumberType = NumberType;
($traceurRuntime.createClass)(NumberType, {}, {}, Type);
var StringType = function StringType() {
  $traceurRuntime.superCall(this, $StringType.prototype, "constructor", [{name: 'string'}]);
};
var $StringType = StringType;
($traceurRuntime.createClass)(StringType, {}, {}, Type);
var ObjectType = function ObjectType(options) {
  options = options || {};
  $traceurRuntime.superCall(this, $ObjectType.prototype, "constructor", [options.name || 'anonymous object']);
  this.properties = options.properties || {};
  this.proto = options.proto || null;
};
var $ObjectType = ObjectType;
($traceurRuntime.createClass)(ObjectType, {}, {}, Type);
var ArrayType = function ArrayType() {
  if (!options || !options.elementType) {
    handleInternalError('Invalid options passed to ArrayType constructor.');
  }
  $traceurRuntime.superCall(this, $ArrayType.prototype, "constructor", [options.name || 'anonymous array']);
  this.elementType = options.elementType;
};
var $ArrayType = ArrayType;
($traceurRuntime.createClass)(ArrayType, {}, {}, Type);
var FunctionType = function FunctionType(options) {
  if (!options || !options.node) {
    handleInternalError('Invalid options passed to FunctionType constructor.');
  }
  $traceurRuntime.superCall(this, $FunctionType.prototype, "constructor", [options.name || 'anonymous function']);
  this.node = options.node;
  this.argumentTypes = options.arguments || [];
  this.returnType = options.returnType || null;
};
var $FunctionType = FunctionType;
($traceurRuntime.createClass)(FunctionType, {applyPattern: function(options) {
    if (!options || !options.argumentTypes || !options.returnType) {
      handleInternalError('Invalid options passed to FunctionType constructor.');
    }
  }}, {}, Type);
var ConstructorType = function ConstructorType(options) {
  if (!options || !options.name || !options.instantiatedType) {
    handleInternalError('Invalid options passed to ConstructorType constructor.');
  }
  $traceurRuntime.superCall(this, $ConstructorType.prototype, "constructor", [options.name]);
  this.argumentTypes = options.argumentTypes || [];
  this.instantiatedType = options.instantiatedType;
};
var $ConstructorType = ConstructorType;
($traceurRuntime.createClass)(ConstructorType, {}, {}, Type);
function isBoolean(type) {
  return type instanceof BooleanType;
}
function isNumber(type) {
  return type instanceof NumberType;
}
function isString(type) {
  return type instanceof StringType;
}
function isPrimitive(type) {
  return isBoolean(type) || isNumber(type) || isString(type);
}
function isObject(type) {
  return type instanceof ObjectType;
}
function isArray(type) {
  return type instanceof ArrayType;
}
function isFunction(type) {
  return type instanceof FunctionType;
}
function isConstructor(type) {
  return type instanceof ConstructorType;
}
function compareTypes(type1, type2, options) {
  if (!options || !options.node) {
    handleInternalError('Invalid options passed to compareTypes.');
  }
  if (type1 == type2) {
    return true;
  }
  function handleCompareError(errorMessage) {
    handleError(options.node, 'Cannot cast "' + type1.name + '" (declared at ' + type1.declarationLocation + ') as "' + type2.name + '" (declared at ' + type2.declarationLocation + ')' + (errorMessage ? ': ' + errorMessage : ''));
  }
  if (isPrimitive(type1) && isPrimitive(type2)) {
    if ((isBoolean(type1) && isBoolean(type2)) || (isNumber(type1) && isNumber(type2)) || (isString(type1) && isString(type2))) {
      return true;
    } else {
      handleCompareError();
      return false;
    }
  }
  var p;
  if (isObject(type1) && isObject(type2)) {
    if (!compareTypes(type1.proto, type2.proto, options)) {
      return false;
    }
    if (Object.keys(type1.properties).length != Object.keys(type2.properties).length) {
      handleCompareError('Objects do not contain the same number of properties');
      return false;
    }
    for (p in type1.properties) {
      if (!type2.properties[p]) {
        handleCompareError('Object type is missing property "' + p + '"');
        return false;
      }
      if (!compareTypes(type1.properties[p], type2.properties[p], options)) {
        handleCompareError('Property "' + p + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  var i;
  if (isFunction(type1) && isFunction(type2)) {
    if (!compareTypes(type1.returnType, type2.returnType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Functions do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  if (isConstructor(type1) && isConstructor(type2)) {
    if (!compareTypes(type1.instantiatedType, type2.instantiatedType, options)) {
      return false;
    }
    if (type1.argumentTypes.length != type2.argumentTypes.length) {
      handleCompareError('Constructors do not contain the same number of arguments');
      return false;
    }
    for (i = 0; i < type1.argumentTypes.length; i++) {
      if (!compareTypes(type1.argumentTypes[i], type2.argumentTypes[i], options)) {
        handleCompareError('Argument "' + i + '" type mismatch');
        return false;
      }
    }
    return true;
  }
  return false;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGUuanMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci80IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMiIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci81IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzAiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci84IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzkiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMTAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0JBO0FDeEJBLEtBQUssaUJBQWlCLEFBQUMsQ0FBQyxPQUFNO2FDQTlCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHdCQUF3QjtJQUFFLEFEQTlCLENBQUM7WUFBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUsdUJBQXdCO0lBQUUsQURBOUIsQ0FBQztZQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSx1QkFBd0I7SUFBRSxBREE5QixDQUFDO1lBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHVCQUF3QjtJQUFFLEFEQTlCLENBQUM7V0FBdkIsRUFBQyxHQUFFLFlDQXFCO0FBQUUsc0JBQXdCO0lBQUUsQURBOUIsQ0FBQztjQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSx5QkFBd0I7SUFBRSxBREE5QixDQUFDO2lCQUF2QixFQUFDLEdBQUUsWUNBcUI7QUFBRSw0QkFBd0I7SUFBRSxBREE5QixDQUFDO1dBQXZCLEVBQUMsR0FBRSxZQ0FxQjtBQUFFLHNCQUF3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QUFBQyxDQUFDLFlBQVcsRUFBSSxFQUFBLENBQUEsQ0FBSSxrQkFBZ0IsQ0FBQyxDQUFDO0FBQ3hELGFBQU8sTUFBSSxDQUFDO01BQ2Q7QUFBQSxJQUNGO0FBQUEsQUFDQSxTQUFPLEtBQUcsQ0FBQztFQUNiO0FBQUEsQUFFQSxLQUFJLGFBQVksQUFBQyxDQUFDLEtBQUksQ0FBQyxDQUFBLEVBQUssQ0FBQSxhQUFZLEFBQUMsQ0FBQyxLQUFJLENBQUMsQ0FBRztBQUNoRCxPQUFJLENBQUMsWUFBVyxBQUFDLENBQUMsS0FBSSxpQkFBaUIsQ0FBRyxDQUFBLEtBQUksaUJBQWlCLENBQUcsUUFBTSxDQUFDLENBQUc7QUFDMUUsV0FBTyxNQUFJLENBQUM7SUFDZDtBQUFBLEFBQ0EsT0FBSSxLQUFJLGNBQWMsT0FBTyxHQUFLLENBQUEsS0FBSSxjQUFjLE9BQU8sQ0FBRztBQUM1RCx1QkFBaUIsQUFBQyxDQUFDLDBEQUF5RCxDQUFDLENBQUM7QUFDOUUsV0FBTyxNQUFJLENBQUM7SUFDZDtBQUFBLEFBQ0EsUUFBSyxDQUFBLEVBQUksRUFBQSxDQUFHLENBQUEsQ0FBQSxFQUFJLENBQUEsS0FBSSxjQUFjLE9BQU8sQ0FBRyxDQUFBLENBQUEsRUFBRSxDQUFHO0FBQy9DLFNBQUksQ0FBQyxZQUFXLEFBQUMsQ0FBQyxLQUFJLGNBQWMsQ0FBRSxDQUFBLENBQUMsQ0FBRyxDQUFBLEtBQUksY0FBYyxDQUFFLENBQUEsQ0FBQyxDQUFHLFFBQU0sQ0FBQyxDQUFHO0FBQzFFLHlCQUFpQixBQUFDLENBQUMsWUFBVyxFQUFJLEVBQUEsQ0FBQSxDQUFJLGtCQUFnQixDQUFDLENBQUM7QUFDeEQsYUFBTyxNQUFJLENBQUM7TUFDZDtBQUFBLElBQ0Y7QUFBQSxBQUNBLFNBQU8sS0FBRyxDQUFDO0VBQ2I7QUFBQSxBQUVBLE9BQU8sTUFBSSxDQUFDO0FBQ2Q7QUFBQSIsImZpbGUiOiJ0eXBlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcblRoZSBNSVQgTGljZW5zZSAoTUlUKVxuXG5Db3B5cmlnaHQgKGMpIDIwMTMtMjAxNCBCcnlhbiBIdWdoZXMgPGJyeWFuQHRoZW9yZXRpY2FsaWRlYXRpb25zLmNvbT4gKGh0dHA6Ly90aGVvcmV0aWNhbGlkZWF0aW9ucy5jb20pXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbmluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW5cbmFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbkZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbk9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cblRIRSBTT0ZUV0FSRS5cbiovXG5cbmltcG9ydCB7IGhhbmRsZUVycm9yLCBoYW5kbGVJbnRlcm5hbEVycm9yIH0gZnJvbSAnLi9zdGF0ZSc7XG5cbmNsYXNzIFR5cGUge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgIHRoaXMuZGVjbGFyYXRpb25Mb2NhdGlvbiA9IG9wdGlvbnMuZGVjbGFyYXRpb25Mb2NhdGlvbjtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQm9vbGVhblR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyBuYW1lOiAnYm9vbGVhbicgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE51bWJlclR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyBuYW1lOiAnbnVtYmVyJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3RyaW5nVHlwZSBleHRlbmRzIFR5cGUge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcih7IG5hbWU6ICdzdHJpbmcnIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPYmplY3RUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBzdXBlcihvcHRpb25zLm5hbWUgfHwgJ2Fub255bW91cyBvYmplY3QnKTtcbiAgICB0aGlzLnByb3BlcnRpZXMgPSBvcHRpb25zLnByb3BlcnRpZXMgfHwge307XG4gICAgdGhpcy5wcm90byA9IG9wdGlvbnMucHJvdG8gfHwgbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQXJyYXlUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5lbGVtZW50VHlwZSkge1xuICAgIGhhbmRsZUludGVybmFsRXJyb3IoJ0ludmFsaWQgb3B0aW9ucyBwYXNzZWQgdG8gQXJyYXlUeXBlIGNvbnN0cnVjdG9yLicpO1xuICB9XG4gIHN1cGVyKG9wdGlvbnMubmFtZSB8fCAnYW5vbnltb3VzIGFycmF5Jyk7XG4gIHRoaXMuZWxlbWVudFR5cGUgPSBvcHRpb25zLmVsZW1lbnRUeXBlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGdW5jdGlvblR5cGUgZXh0ZW5kcyBUeXBlIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5ub2RlKSB7XG4gICAgICBoYW5kbGVJbnRlcm5hbEVycm9yKCdJbnZhbGlkIG9wdGlvbnMgcGFzc2VkIHRvIEZ1bmN0aW9uVHlwZSBjb25zdHJ1Y3Rvci4nKTtcbiAgICB9XG4gICAgc3VwZXIob3B0aW9ucy5uYW1lIHx8ICdhbm9ueW1vdXMgZnVuY3Rpb24nKTtcbiAgICB0aGlzLm5vZGUgPSBvcHRpb25zLm5vZGU7XG4gICAgdGhpcy5hcmd1bWVudFR5cGVzID0gb3B0aW9ucy5hcmd1bWVudHMgfHwgW107XG4gICAgdGhpcy5yZXR1cm5UeXBlID0gb3B0aW9ucy5yZXR1cm5UeXBlIHx8IG51bGw7XG4gIH1cbiAgYXBwbHlQYXR0ZXJuKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMuYXJndW1lbnRUeXBlcyB8fCAhb3B0aW9ucy5yZXR1cm5UeXBlKSB7XG4gICAgICBoYW5kbGVJbnRlcm5hbEVycm9yKCdJbnZhbGlkIG9wdGlvbnMgcGFzc2VkIHRvIEZ1bmN0aW9uVHlwZSBjb25zdHJ1Y3Rvci4nKTtcbiAgICB9XG4gICAgLy8gVE9ETzogVGhpcyBpcyBjYWxsZWQgYnkgY2FsbCBleHByZXNzaW9ucyB0byBzb2xpZGlmeSB0eXBlcy4gQW5hbGF5emVzIGZ1bmN0aW9uIGF0IHRoaXMgcG9pbnQgaW4gdGltZS5cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29uc3RydWN0b3JUeXBlIGV4dGVuZHMgVHlwZSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMgfHwgIW9wdGlvbnMubmFtZSB8fCAhb3B0aW9ucy5pbnN0YW50aWF0ZWRUeXBlKSB7XG4gICAgICBoYW5kbGVJbnRlcm5hbEVycm9yKCdJbnZhbGlkIG9wdGlvbnMgcGFzc2VkIHRvIENvbnN0cnVjdG9yVHlwZSBjb25zdHJ1Y3Rvci4nKTtcbiAgICB9XG4gICAgc3VwZXIob3B0aW9ucy5uYW1lKTtcbiAgICB0aGlzLmFyZ3VtZW50VHlwZXMgPSBvcHRpb25zLmFyZ3VtZW50VHlwZXMgfHwgW107XG4gICAgdGhpcy5pbnN0YW50aWF0ZWRUeXBlID0gb3B0aW9ucy5pbnN0YW50aWF0ZWRUeXBlO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jvb2xlYW4odHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIEJvb2xlYW5UeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOdW1iZXIodHlwZSkge1xuICByZXR1cm4gdHlwZSBpbnN0YW5jZW9mIE51bWJlclR5cGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyh0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgU3RyaW5nVHlwZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJpbWl0aXZlKHR5cGUpIHtcbiAgcmV0dXJuIGlzQm9vbGVhbih0eXBlKSB8fCBpc051bWJlcih0eXBlKSB8fCBpc1N0cmluZyh0eXBlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUgaW5zdGFuY2VvZiBPYmplY3RUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBcnJheSh0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgQXJyYXlUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbih0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb25UeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDb25zdHJ1Y3Rvcih0eXBlKSB7XG4gIHJldHVybiB0eXBlIGluc3RhbmNlb2YgQ29uc3RydWN0b3JUeXBlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVR5cGVzKHR5cGUxLCB0eXBlMiwgb3B0aW9ucykge1xuXG4gIGlmICghb3B0aW9ucyB8fCAhb3B0aW9ucy5ub2RlKSB7XG4gICAgaGFuZGxlSW50ZXJuYWxFcnJvcignSW52YWxpZCBvcHRpb25zIHBhc3NlZCB0byBjb21wYXJlVHlwZXMuJyk7XG4gIH1cbiAgaWYgKHR5cGUxID09IHR5cGUyKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBoYW5kbGVDb21wYXJlRXJyb3IoZXJyb3JNZXNzYWdlKSB7XG4gICAgaGFuZGxlRXJyb3Iob3B0aW9ucy5ub2RlLCAnQ2Fubm90IGNhc3QgXCInICsgdHlwZTEubmFtZSArICdcIiAoZGVjbGFyZWQgYXQgJyArIHR5cGUxLmRlY2xhcmF0aW9uTG9jYXRpb24gK1xuICAgICAgJykgYXMgXCInICsgdHlwZTIubmFtZSArICdcIiAoZGVjbGFyZWQgYXQgJyArIHR5cGUyLmRlY2xhcmF0aW9uTG9jYXRpb24gKyAnKScgK1xuICAgICAgKGVycm9yTWVzc2FnZSA/ICc6ICcgKyBlcnJvck1lc3NhZ2UgOiAnJykpO1xuICB9XG5cbiAgaWYgKGlzUHJpbWl0aXZlKHR5cGUxKSAmJiBpc1ByaW1pdGl2ZSh0eXBlMikpIHtcbiAgICBpZiAoKGlzQm9vbGVhbih0eXBlMSkgJiYgaXNCb29sZWFuKHR5cGUyKSkgfHxcbiAgICAgIChpc051bWJlcih0eXBlMSkgJiYgaXNOdW1iZXIodHlwZTIpKSB8fFxuICAgICAgKGlzU3RyaW5nKHR5cGUxKSAmJiBpc1N0cmluZyh0eXBlMikpXG4gICAgKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGFuZGxlQ29tcGFyZUVycm9yKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgdmFyIHA7XG4gIGlmIChpc09iamVjdCh0eXBlMSkgJiYgaXNPYmplY3QodHlwZTIpKSB7XG4gICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEucHJvdG8sIHR5cGUyLnByb3RvLCBvcHRpb25zKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoT2JqZWN0LmtleXModHlwZTEucHJvcGVydGllcykubGVuZ3RoICE9IE9iamVjdC5rZXlzKHR5cGUyLnByb3BlcnRpZXMpLmxlbmd0aCkge1xuICAgICAgaGFuZGxlQ29tcGFyZUVycm9yKCdPYmplY3RzIGRvIG5vdCBjb250YWluIHRoZSBzYW1lIG51bWJlciBvZiBwcm9wZXJ0aWVzJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZvciAocCBpbiB0eXBlMS5wcm9wZXJ0aWVzKSB7XG4gICAgICBpZiAoIXR5cGUyLnByb3BlcnRpZXNbcF0pIHtcbiAgICAgICAgaGFuZGxlQ29tcGFyZUVycm9yKCdPYmplY3QgdHlwZSBpcyBtaXNzaW5nIHByb3BlcnR5IFwiJyArIHAgKyAnXCInKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCFjb21wYXJlVHlwZXModHlwZTEucHJvcGVydGllc1twXSwgdHlwZTIucHJvcGVydGllc1twXSwgb3B0aW9ucykpIHtcbiAgICAgICAgaGFuZGxlQ29tcGFyZUVycm9yKCdQcm9wZXJ0eSBcIicgKyBwICsgJ1wiIHR5cGUgbWlzbWF0Y2gnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIFRPRE86IE5lZWQgdG8gcmV0aGluayBpbiB0ZXJtcyBvZiBwYXJ0aWFsIGRlZmluaXRpb25zXG4gIHZhciBpO1xuICBpZiAoaXNGdW5jdGlvbih0eXBlMSkgJiYgaXNGdW5jdGlvbih0eXBlMikpIHtcbiAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5yZXR1cm5UeXBlLCB0eXBlMi5yZXR1cm5UeXBlLCBvcHRpb25zKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZTEuYXJndW1lbnRUeXBlcy5sZW5ndGggIT0gdHlwZTIuYXJndW1lbnRUeXBlcy5sZW5ndGgpIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignRnVuY3Rpb25zIGRvIG5vdCBjb250YWluIHRoZSBzYW1lIG51bWJlciBvZiBhcmd1bWVudHMnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLmFyZ3VtZW50VHlwZXNbaV0sIHR5cGUyLmFyZ3VtZW50VHlwZXNbaV0sIG9wdGlvbnMpKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignQXJndW1lbnQgXCInICsgaSArICdcIiB0eXBlIG1pc21hdGNoJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBpZiAoaXNDb25zdHJ1Y3Rvcih0eXBlMSkgJiYgaXNDb25zdHJ1Y3Rvcih0eXBlMikpIHtcbiAgICBpZiAoIWNvbXBhcmVUeXBlcyh0eXBlMS5pbnN0YW50aWF0ZWRUeXBlLCB0eXBlMi5pbnN0YW50aWF0ZWRUeXBlLCBvcHRpb25zKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZTEuYXJndW1lbnRUeXBlcy5sZW5ndGggIT0gdHlwZTIuYXJndW1lbnRUeXBlcy5sZW5ndGgpIHtcbiAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignQ29uc3RydWN0b3JzIGRvIG5vdCBjb250YWluIHRoZSBzYW1lIG51bWJlciBvZiBhcmd1bWVudHMnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IHR5cGUxLmFyZ3VtZW50VHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghY29tcGFyZVR5cGVzKHR5cGUxLmFyZ3VtZW50VHlwZXNbaV0sIHR5cGUyLmFyZ3VtZW50VHlwZXNbaV0sIG9wdGlvbnMpKSB7XG4gICAgICAgIGhhbmRsZUNvbXBhcmVFcnJvcignQXJndW1lbnQgXCInICsgaSArICdcIiB0eXBlIG1pc21hdGNoJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG4iLCJPYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCAkX19wbGFjZWhvbGRlcl9fMCk7Iiwie2dldDogJF9fcGxhY2Vob2xkZXJfXzB9IiwiZ2V0ICRfX3BsYWNlaG9sZGVyX18wKCkgeyByZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzE7IH0iLCJfX2VzTW9kdWxlOiB0cnVlIiwie3ZhbHVlOiAkX19wbGFjZWhvbGRlcl9fMH0iLCIoJF9fcGxhY2Vob2xkZXJfXzAgPSByZXF1aXJlKCRfX3BsYWNlaG9sZGVyX18xKSwgXG4gICAgICAgICRfX3BsYWNlaG9sZGVyX18yICYmICRfX3BsYWNlaG9sZGVyX18zLl9fZXNNb2R1bGUgJiYgJF9fcGxhY2Vob2xkZXJfXzQgfHwge2RlZmF1bHQ6ICRfX3BsYWNlaG9sZGVyX181fSkiLCJ2YXIgJF9fcGxhY2Vob2xkZXJfXzAgPSAkX19wbGFjZWhvbGRlcl9fMSIsIigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSwgJF9fcGxhY2Vob2xkZXJfXzIpIiwiJHRyYWNldXJSdW50aW1lLnN1cGVyQ2FsbCgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMykiLCJ2YXIgJF9fcGxhY2Vob2xkZXJfXzAgPSAkX19wbGFjZWhvbGRlcl9fMSIsIigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSwgJF9fcGxhY2Vob2xkZXJfXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMykiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=